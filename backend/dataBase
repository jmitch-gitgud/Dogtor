CREATE EXTENSION IF NOT EXISTS "uuid-ossp";
SELECT uuid_generate_v1();
CREATE EXTENSION if not exists pgcrypto SCHEMA public;

CREATE TABLE admins (
	admin_id uuid DEFAULT uuid_generate_v4 (),
	admin_name VARCHAR NOT NULL,
	admin_password VARCHAR NOT NULL,
	PRIMARY KEY(admin_id)
);

CREATE TABLE clients(
	client_id uuid DEFAULT uuid_generate_v4 (),
	client_username VARCHAR NOT NULL,
	client_password VARCHAR NOT NULL,
	client_notes VARCHAR,
	PRIMARY KEY(client_id)
);

CREATE TABLE pets(
	pet_id uuid DEFAULT uuid_generate_v4 (),
	pet_name VARCHAR NOT NULL,
	pet_appointements_notes TEXT [],
	owner_id uuid,
	pet_age int,
	pet_weight int,
	pet_sex VARCHAR, 
	pet_neutered BOOLEAN,
	who_performed_last VARCHAR,
	last_date date,
	pets_behaviour TEXT,
	pet_active BOOLEAN,
	PRIMARY KEY(pet_id),
	FOREIGN KEY (owner_id) REFERENCES "clients" (client_id)
);

CREATE TABLE vets(
	vets_id uuid DEFAULT uuid_generate_v4 (),
	vets_username VARCHAR NOT NULL,
	vets_password VARCHAR NOT NULL,
	vets_skills text[],
	vets_speciality VARCHAR,
	vets_start_time time,
	vets_end_time time,
	PRIMARY KEY(vets_id)
);

CREATE TABLE technicians(
	technicians_id uuid DEFAULT uuid_generate_v4 (),
	technicians_username VARCHAR NOT NULL,
	technicians_password VARCHAR NOT NULL,
	technicians_skills text[],
	vets_speciality VARCHAR,
	technicians_start_time time,
	technicians_end_time time,
	PRIMARY KEY(technicians_id)
);

CREATE TABLE veterinary_assistant(
	veterinary_assistant_id uuid DEFAULT uuid_generate_v4 (),
	veterinary_assistant_username VARCHAR NOT NULL,
	veterinary_assistant_password VARCHAR NOT NULL,
	veterinary_assistant_skills text[],
	veterinary_assistant_start_time time,
	veterinary_assistant_end_time time,
	PRIMARY KEY(technicians_id)
);


CREATE TABLE appointment(
	appointment_id uuid DEFAULT uuid_generate_v4 (),
	appointment_date DATE,
	appointment_details VARCHAR(500),
	assigned_vets_id uuid,
	assigned_technicians_id uuid,
	assigned_pets_id uuid,
	assigned_Client_id uuid,
	chief_complaint VARCHAR,
	FOREIGN KEY (assigned_Client_id) REFERENCES "clients" (client_id),
	FOREIGN KEY (assigned_pets_id) REFERENCES "pets" (pet_id),
	FOREIGN KEY (assigned_technicians_id) REFERENCES "technicians" (technicians_id),
	FOREIGN KEY (assigned_vets_id) REFERENCES "vets" (vets_id),
	PRIMARY KEY(appointment_id)
);

CREATE TABLE blocks(
	block_id uuid DEFAULT uuid_generate_v4 (),		
	blockInt int,
	assigned_appointment_id uuid,
	FOREIGN KEY (assigned_appointment_id) REFERENCES "appointment" (appointment_id),
	PRIMARY KEY(block_id)
);

CREATE TABLE appointment_type(
	appointment_type_id uuid DEFAULT uuid_generate_v4 (),
	appointment_type_catagory VARCHAR,
	appointment_type_value VARCHAR,
	appointment_type_duration INT,
	PRIMARY KEY(appointment_type_id)
);

INSERT INTO appointment_type(appointment_type_catagory,appointment_type_value,appointment_type_duration) VALUES ('General Appointment','Checkups',30);
INSERT INTO appointment_type(appointment_type_catagory,appointment_type_value,appointment_type_duration) VALUES ('General Appointment','Vaccines',30);
INSERT INTO appointment_type(appointment_type_catagory,appointment_type_value,appointment_type_duration) VALUES ('General Appointment','Ear Infections',30);
INSERT INTO appointment_type(appointment_type_catagory,appointment_type_value,appointment_type_duration) VALUES ('General Appointment','Consultations',30);
INSERT INTO appointment_type(appointment_type_catagory,appointment_type_value,appointment_type_duration) VALUES ('General Appointment','Annual Appointment',30);
INSERT INTO appointment_type(appointment_type_catagory,appointment_type_value,appointment_type_duration) VALUES ('Sick Appointment','Pet is under some form of distress',60);
INSERT INTO appointment_type(appointment_type_catagory,appointment_type_value,appointment_type_duration) VALUES ('Technician Appointment','Technician performs task',15);
INSERT INTO appointment_type(appointment_type_catagory,appointment_type_value,appointment_type_duration) VALUES ('Exotic Appointment','Exotic Animal appointment',45);
INSERT INTO appointment_type(appointment_type_catagory,appointment_type_value) VALUES ('Emergency Appointment','Extreme situation where care is needed immediatly');
INSERT INTO appointment_type(appointment_type_catagory,appointment_type_value,appointment_type_duration) VALUES ('Surgeries','Ortho', 240);
INSERT INTO appointment_type(appointment_type_catagory,appointment_type_value,appointment_type_duration) VALUES ('Surgeries','Dental', 180);
INSERT INTO appointment_type(appointment_type_catagory,appointment_type_value,appointment_type_duration) VALUES ('Surgeries','Spay(dog)', 45);
INSERT INTO appointment_type(appointment_type_catagory,appointment_type_value,appointment_type_duration) VALUES ('Surgeries','Neuter(dog)', 15);
INSERT INTO appointment_type(appointment_type_catagory,appointment_type_value,appointment_type_duration) VALUES ('Surgeries','Spay(cat)', 30);
INSERT INTO appointment_type(appointment_type_catagory,appointment_type_value,appointment_type_duration) VALUES ('Surgeries','Neuter(cat)', 15);
INSERT INTO appointment_type(appointment_type_catagory,appointment_type_value,appointment_type_duration) VALUES ('Surgeries','Exotic Surgery', 120);










INSERT INTO admins(admin_name,admin_password) VALUES ('AndreAucoin',crypt('password', gen_salt('md5')));
INSERT INTO clients(client_username, client_password) VALUES ('JohnDuck',crypt('password', gen_salt('md5')));
INSERT INTO vets(vets_username, vets_password,vets_skills ) VALUES ('Donald Duck',crypt('password', gen_salt('md5')), null);
INSERT INTO technicians(technicians_username, technicians_password,technicians_skills ) VALUES ('Scrooge Mc Duck',crypt('password', gen_salt('md5')), null);